<section>
  <h1>Countries</h1>

  <table>
    <tr>
      <td>
        <div id="visited_countries_chart" class="simple_pie_chart" width='300px' height='100px'>
          <table>
            <tr>
              <th>Visited</th>
              <td><%= current_user.countries.count %></td>
            </tr>
            <tr>
              <th>Not Visited</th>
              <td><%= current_user.not_visited_countries.count %></td>
            </tr>
          </table>
        </div>
      </td>
    </tr>
    <tr>
      <td>
        <div>
          <%= search_form_for @q do |f| %>
            <%= f.label :name_or_code_cont, 'Name or Country' %>
            <%= f.text_field :name_or_code_cont %>
            <%= f.submit %>
          <% end %>
        </div>
      </td>
    </tr>
  </table>

  <table id="countries_table">
    <tr>
      <th><%= sort_link @q, :name %></th>
      <th><%= sort_link @q, :code %></th>
      <th>Status</th>
      <th></th>
      <th></th>
    </tr>

  <% @countries.each do |country| %>
    <tr>
      <td><%= country.name %></td>
      <td><%= country.code %></td>
      <td><%= country.visited_by_user?(current_user) ? 'Visited' : 'Not Visited' %></td>
      <td><%= link_to 'Show', country %></td>
      <td><%= link_to 'Edit', edit_country_path(country) %></td>
    </tr>
  <% end %>
  </table>
</section>
