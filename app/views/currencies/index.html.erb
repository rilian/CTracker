<%= render 'line_chart' %>

<section>
  <h1>Currencies</h1>

  <table>
    <tr>
      <td>
        <div id="collected_currencies_chart" class="simple_pie_chart" width='300px' height='100px'>
          <%= render 'pie_chart' %>
        </div>
      </td>
      <td>
        <div id="visualization" style="width: 340px; height: 200px;">No data for currencies collected chart</div>
      </td>
    </tr>
    <tr>
      <td>
        <div>
          <%= search_form_for @q do |f| %>
            <%= f.label :name_or_code_or_country_id_or_country_code_cont, 'Name or Country' %>
            <%= f.text_field :name_or_code_or_country_id_or_country_code_cont %>
            <%= f.submit %>
          <% end %>
        </div>
      </td>
    </tr>
  </table>

  <%= form_tag collect_multiple_currencies_path, html: { method: :post }, class: 'currencies_form', remote: true do %>
    <%= submit_tag 'Collect Selected Currencies', :class => 'collect_currencies' %>
    <table>
      <tr>
        <th>
          <%= label_tag :select_all %>
          <%= check_box_tag :select_all %>
        </th>
        <th><%= sort_link @q, :name %></th>
        <th><%= sort_link @q, :code %></th>
        <th>Status</th>
        <th></th>
      </tr>

      <% @currencies.each do |currency| %>
        <tr data-currency_id="<%= currency.id %>">
          <td class="checker"><%= check_box_tag('currency_ids[]', currency.id, false, {'data-currency_id' => currency.id}) unless (currency.collected_by_user?(current_user) || currency.country.blank?) %></td>
          <td><%= currency.name %></td>
          <td><%= currency.code %></td>
          <td class="status"><%= currency.collected_by_user?(current_user) ? 'Collected' : 'Not Collected' %></td>
          <td><%= link_to 'Show', currency %></td>
        </tr>
      <% end %>
    </table>
  <% end %>
</section>
